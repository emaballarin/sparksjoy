# ============================================================================
# Log Rotation Configuration for ComfyUI
# ============================================================================
# This configuration rotates logs to prevent disk space exhaustion
# Install with: ./scripts/setup-logrotate.sh

# ComfyUI application logs
/home/emaballarin/repositories/sparksjoy/docker/comfyui/logs/comfyui/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
    dateext
    dateformat -%Y%m%d
    extension .log
    sharedscripts
    postrotate
        # Signal ComfyUI to reopen log files (if applicable)
        # docker compose -f /path/to/docker-compose.yml exec comfyui kill -USR1 1 2>/dev/null || true
    endscript
}

# Traefik logs
/home/emaballarin/repositories/sparksjoy/docker/comfyui/logs/traefik/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
    dateext
    dateformat -%Y%m%d
    extension .log
    sharedscripts
    postrotate
        # Signal Traefik to reopen log files
        docker compose -f /home/emaballarin/repositories/sparksjoy/docker/comfyui/docker-compose.yml exec traefik kill -USR1 1 2>/dev/null || true
    endscript
}

# Docker container logs (JSON files)
/var/lib/docker/containers/*/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    copytruncate
    maxsize 100M
}
